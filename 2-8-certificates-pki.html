<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Certificates & PKI - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
      <!-- Navigation generated by JavaScript -->
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l2">L2 Technical</div>
          <h1>Certificates & PKI</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What This Page Covers</h3>
            <p>Public Key Infrastructure (PKI) provides the foundation for secure authentication through certificates. This covers X.509 certificates, certificate authorities, smart cards, and certificate-based authentication.</p>
          </div>

          <h2 id="pki-hierarchy">PKI Hierarchy</h2>
          <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PKI TRUST HIERARCHY                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚                        â”‚   ROOT CA       â”‚  Self-signed, offline, highly protected     â”‚
â”‚                        â”‚   (Trust Anchor)â”‚  Validity: 20-30 years                      â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚                                 â”‚                                                       â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚              â–¼                  â–¼                  â–¼                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚     â”‚ ISSUING CA  â”‚     â”‚ ISSUING CA  â”‚    â”‚ ISSUING CA  â”‚  Online, issues certs      â”‚
â”‚     â”‚ (Users)     â”‚     â”‚ (Servers)   â”‚    â”‚ (Code Sign) â”‚  Validity: 5-10 years      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚            â”‚                   â”‚                  â”‚                                    â”‚
â”‚            â–¼                   â–¼                  â–¼                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚     â”‚User Certs â”‚       â”‚TLS Certs  â”‚      â”‚Code Certs â”‚  End-entity certificates    â”‚
â”‚     â”‚Smart Cardsâ”‚       â”‚Servers    â”‚      â”‚Signing    â”‚  Validity: 1-3 years        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                                          â”‚
â”‚   TRUST: If you trust Root CA, you trust all certs issued by its subordinate CAs       â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>

          <h2 id="x509">X.509 Certificate Structure</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">Certificate Fields</span></div><pre><code># VIEW CERTIFICATE DETAILS
openssl x509 -in cert.pem -text -noout

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1234567890
        
    Signature Algorithm: sha256WithRSAEncryption
    
    Issuer: CN=Company Issuing CA, O=Company Inc
    
    Validity
        Not Before: Jan  1 00:00:00 2024 GMT
        Not After : Jan  1 00:00:00 2025 GMT
        
    Subject: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e7a4a9da8d888f89c9948a8e938fa784888a9786899ec984888a">[email&#160;protected]</a>, O=Company Inc
    
    Subject Public Key Info:
        Public Key Algorithm: rsaEncryption
        RSA Public-Key: (2048 bit)
        
    X509v3 extensions:
        Key Usage: Digital Signature, Key Encipherment
        Extended Key Usage: Client Authentication, Smartcard Logon
        Subject Alternative Name: 
            email:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f19b9e999fdf829c988599b1929e9c81909f88df929e9c">[email&#160;protected]</a>
            URI:urn:uuid:12345-67890-abcdef
        CRL Distribution Points: 
            URI:http://pki.company.com/crl/issuing-ca.crl
        Authority Information Access: 
            OCSP - URI:http://ocsp.company.com</code></pre></div>

          <h2 id="auth-types">Certificate Authentication Types</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Type</th><th>Use Case</th><th>How It Works</th></tr></thead>
            <tbody>
              <tr><td><strong>Smart Card</strong></td><td>User login to Windows</td><td>Certificate on PIV/CAC card + PIN</td></tr>
              <tr><td><strong>Client TLS (mTLS)</strong></td><td>API/service authentication</td><td>Both client and server present certs</td></tr>
              <tr><td><strong>VPN</strong></td><td>Remote access</td><td>User cert proves identity to VPN</td></tr>
              <tr><td><strong>Wi-Fi (EAP-TLS)</strong></td><td>802.1X network auth</td><td>Device cert for network access</td></tr>
              <tr><td><strong>Code Signing</strong></td><td>Software integrity</td><td>Proves software from trusted publisher</td></tr>
            </tbody>
          </table></div>

          <h2 id="day-to-day">ğŸ”§ Security Engineer Day-to-Day Tasks</h2>
          <div class="callout tip"><div class="callout-content"><div class="callout-title">ğŸ‘¨â€ğŸ’» What You Actually Do</div>
            
            <p><strong>Certificate Management:</strong></p>
            <ul>
              <li>Monitor certificate expiration (set alerts 60, 30, 14 days out)</li>
              <li>Renew certificates before expiry</li>
              <li>Revoke compromised certificates (add to CRL/OCSP)</li>
              <li>Issue new user/device certificates</li>
            </ul>

            <p><strong>Common Tickets:</strong></p>
            <ul>
              <li><strong>"Smart card not working"</strong> â†’ Check PIN, certificate validity, CRL access</li>
              <li><strong>"Certificate expired"</strong> â†’ Renew, redistribute, update trust stores</li>
              <li><strong>"Can't connect to VPN"</strong> â†’ Verify user cert, check revocation status</li>
              <li><strong>"Website cert warning"</strong> â†’ Chain issue or missing intermediate CA</li>
            </ul>

            <p><strong>PKI Operations:</strong></p>
            <ul>
              <li>Manage certificate templates</li>
              <li>Configure auto-enrollment policies</li>
              <li>Monitor CA health and CRL publication</li>
              <li>Periodic key ceremony for Root CA (if managing internal PKI)</li>
            </ul>
          </div></div>

          <h2 id="troubleshooting">Troubleshooting Checklist</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">Certificate Issues</span></div><pre><code># CHECK CERTIFICATE VALIDITY
openssl x509 -in cert.pem -noout -dates
# Not Before / Not After - is current time in range?

# CHECK CERTIFICATE CHAIN
openssl verify -CAfile ca-chain.pem cert.pem
# Should return: cert.pem: OK

# CHECK REVOCATION STATUS (OCSP)
openssl ocsp -issuer issuer.pem -cert cert.pem \
    -url http://ocsp.company.com -resp_text

# COMMON ISSUES:
1. Certificate expired â†’ Renew and redeploy
2. Chain incomplete â†’ Install intermediate CA certs
3. Revoked cert â†’ Issue new certificate
4. Trust not established â†’ Import Root CA to trust store
5. Wrong key usage â†’ Request cert with correct EKU
6. Name mismatch â†’ SAN doesn't match hostname/email</code></pre></div>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview"><div class="callout-content"><div class="callout-title">ğŸ’¡ Key Interview Points</div>
            <ul>
              <li><strong>PKI hierarchy:</strong> Root CA (offline) â†’ Issuing CA â†’ End-entity certs</li>
              <li><strong>Trust:</strong> Trusting Root CA means trusting all subordinate certs</li>
              <li><strong>Revocation:</strong> CRL (list of revoked) or OCSP (real-time check)</li>
              <li><strong>Smart card:</strong> Something you have (card) + something you know (PIN)</li>
              <li><strong>Key usage:</strong> EKU defines what cert can be used for</li>
            </ul>
          </div></div>

          <nav class="page-nav">
            <a href="2-7-radius-tacacs.html" class="page-nav-link prev"><span class="page-nav-label">â† Previous</span><span class="page-nav-title">RADIUS & TACACS+</span></a>
            <a href="2-9-sso-mechanisms          </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
