<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kerberos - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”</text></svg>">
</head>
<body>
  <div class="page-wrapper">
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
      <div class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-header"><span>1. IAM Foundations</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="1-1-iam-overview.html" class="nav-item">IAM Overview</a>
            <a href="1-2-authn-vs-authz.html" class="nav-item">Authentication vs Authorization</a>
            <a href="1-3-identity-lifecycle.html" class="nav-item">Identity Lifecycle</a>
            <a href="1-4-access-control-models.html" class="nav-item">Access Control Models</a>
            <a href="1-5-least-privilege-sod.html" class="nav-item">Least Privilege & SoD</a>
            <a href="1-6-directory-services.html" class="nav-item">Directory Services</a>
            <a href="1-7-identity-governance.html" class="nav-item">Identity Governance</a>
            <a href="1-8-privileged-access.html" class="nav-item">Privileged Access</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>2. Authentication Protocols</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="2-1-authentication-factors.html" class="nav-item">Authentication Factors</a>
            <a href="2-2-kerberos.html" class="nav-item">Kerberos</a>
            <a href="2-3-ntlm.html" class="nav-item">NTLM</a>
            <a href="2-4-saml.html" class="nav-item">SAML</a>
            <a href="2-5-oauth2.html" class="nav-item">OAuth 2.0</a>
            <a href="2-6-oidc.html" class="nav-item">OpenID Connect</a>
            <a href="2-7-radius-tacacs.html" class="nav-item">RADIUS & TACACS+</a>
            <a href="2-8-certificates-pki.html" class="nav-item">Certificates & PKI</a>
            <a href="2-9-sso-mechanisms.html" class="nav-item">SSO Mechanisms</a>
            <a href="2-10-auth-attacks-defense.html" class="nav-item">Auth Attacks & Defense</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>3. Federation & SSO</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="3-1-federation-fundamentals.html" class="nav-item">Federation Fundamentals</a>
            <a href="3-2-saml-federation.html" class="nav-item">SAML Federation</a>
            <a href="3-3-oidc-federation.html" class="nav-item">OIDC Federation</a>
            <a href="3-4-ws-federation-legacy.html" class="nav-item">WS-Federation & Legacy</a>
            <a href="3-5-b2b-b2c-federation.html" class="nav-item">B2B & B2C Federation</a>
            <a href="3-6-federation-troubleshooting.html" class="nav-item">Federation Troubleshooting</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>4. Microsoft Entra ID</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="4-1-entra-overview.html" class="nav-item">Entra ID Overview</a>
            <a href="4-2-entra-objects.html" class="nav-item">Entra ID Objects</a>
            <a href="4-3-conditional-access.html" class="nav-item">Conditional Access</a>
            <a href="4-4-entra-pim.html" class="nav-item">Entra PIM</a>
            <a href="4-5-entra-governance.html" class="nav-item">Entra Governance</a>
            <a href="4-6-entra-protection.html" class="nav-item">Entra Protection</a>
            <a href="4-7-hybrid-identity.html" class="nav-item">Hybrid Identity</a>
            <a href="4-8-entra-workload-id.html" class="nav-item">Workload Identity</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>5. Okta</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="5-1-okta-overview.html" class="nav-item">Okta Overview</a>
            <a href="5-2-okta-authentication.html" class="nav-item">Okta Authentication</a>
            <a href="5-3-okta-authorization.html" class="nav-item">Okta Authorization</a>
            <a href="5-4-okta-lifecycle.html" class="nav-item">Okta Lifecycle</a>
            <a href="5-5-okta-integration.html" class="nav-item">Okta Integration</a>
            <a href="5-6-okta-admin.html" class="nav-item">Okta Administration</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>6. SailPoint & IGA</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="6-1-sailpoint-overview.html" class="nav-item">SailPoint Overview</a>
            <a href="6-2-iga-fundamentals.html" class="nav-item">IGA Fundamentals</a>
            <a href="6-3-access-certifications.html" class="nav-item">Access Certifications</a>
            <a href="6-4-role-management.html" class="nav-item">Role Management</a>
            <a href="6-5-sod-management.html" class="nav-item">SoD Management</a>
            <a href="6-6-provisioning-workflows.html" class="nav-item">Provisioning Workflows</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>7. Privileged Access (PAM)</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="7-1-pam-overview.html" class="nav-item">PAM Overview</a>
            <a href="7-2-password-vaulting.html" class="nav-item">Password Vaulting</a>
            <a href="7-3-session-management.html" class="nav-item">Session Management</a>
            <a href="7-4-jit-access.html" class="nav-item">Just-in-Time Access</a>
            <a href="7-5-secrets-management.html" class="nav-item">Secrets Management</a>
            <a href="7-6-pam-vendors.html" class="nav-item">PAM Vendors</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>8. Cloud IAM</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="8-1-aws-iam.html" class="nav-item">AWS IAM</a>
            <a href="8-2-aws-identity-center.html" class="nav-item">AWS Identity Center</a>
            <a href="8-3-azure-rbac.html" class="nav-item">Azure RBAC</a>
            <a href="8-4-gcp-iam.html" class="nav-item">GCP IAM</a>
            <a href="8-5-multi-cloud-identity.html" class="nav-item">Multi-Cloud Identity</a>
            <a href="8-6-kubernetes-iam.html" class="nav-item">Kubernetes IAM</a>
            <a href="8-7-infrastructure-as-code.html" class="nav-item">Infrastructure as Code</a>
            <a href="8-8-cloud-pam.html" class="nav-item">Cloud PAM</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>9. IAM Architecture</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="9-1-enterprise-iam-arch.html" class="nav-item">Enterprise IAM Architecture</a>
            <a href="9-2-zero-trust-iam.html" class="nav-item">Zero Trust IAM</a>
            <a href="9-3-hybrid-cloud-iam.html" class="nav-item">Hybrid Cloud IAM</a>
            <a href="9-4-ciam-architecture.html" class="nav-item">CIAM Architecture</a>
            <a href="9-5-api-security.html" class="nav-item">API Security</a>
            <a href="9-6-high-availability.html" class="nav-item">High Availability</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>10. IAM Migrations</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="10-1-migration-planning.html" class="nav-item">Migration Planning</a>
            <a href="10-2-idp-migrations.html" class="nav-item">IdP Migrations</a>
            <a href="10-3-legacy-modernization.html" class="nav-item">Legacy Modernization</a>
            <a href="10-4-iga-pam-migrations.html" class="nav-item">IGA & PAM Migrations</a>
            <a href="10-5-app-migration.html" class="nav-item">Application Migration</a>
            <a href="10-6-coexistence-cutover.html" class="nav-item">Coexistence & Cutover</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>11. Security & Attacks</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="11-1-identity-threat-landscape.html" class="nav-item">Identity Threat Landscape</a>
            <a href="11-2-credential-attacks.html" class="nav-item">Credential Attacks</a>
            <a href="11-3-token-session-attacks.html" class="nav-item">Token & Session Attacks</a>
            <a href="11-4-privilege-escalation.html" class="nav-item">Privilege Escalation</a>
            <a href="11-5-detection-response.html" class="nav-item">Detection & Response</a>
          </div>
        </div>
        <div class="nav-section">
          <div class="nav-section-header collapsed"><span>12. Reference & Interview</span><span class="nav-section-icon">â–¼</span></div>
          <div class="nav-section-items">
            <a href="12-1-iam-glossary.html" class="nav-item">IAM Glossary</a>
            <a href="12-2-interview-questions.html" class="nav-item">Interview Questions</a>
            <a href="12-3-scenario-questions.html" class="nav-item">Scenario Questions</a>
            <a href="12-4-protocol-flows.html" class="nav-item">Protocol Flows</a>
            <a href="12-5-comparison-tables.html" class="nav-item">Comparison Tables</a>
            <a href="12-6-cli-api-reference.html" class="nav-item">CLI & API Reference</a>
          </div>
        </div>
      </div>
    </nav>
    <main class="main-content">
      <header class="content-header">
        <div class="breadcrumb">
          <a href="index.html">Home</a>
          <span class="breadcrumb-separator">â€º</span>
          <span>Authentication Protocols</span>
          <span class="breadcrumb-separator">â€º</span>
          <span>Kerberos</span>
        </div>
        <div class="header-actions">
          <button class="search-trigger">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            <span>Search</span>
            <kbd>âŒ˜K</kbd>
          </button>
        </div>
      </header>
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l2">L2 Technical</div>
          <h1>Kerberos</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What You'll Learn</h3>
            <p>
              Kerberos is a network authentication protocol that uses secret-key cryptography and a trusted 
              third party (KDC) to authenticate users and services. This page covers the complete Kerberos 
              flow, ticket types, Active Directory integration, and security considerations including 
              Golden/Silver ticket attacks.
            </p>
          </div>

          <h2 id="overview">What is Kerberos?</h2>
          <p>
            Kerberos is a ticket-based authentication protocol developed at MIT. Named after the three-headed 
            dog from Greek mythology, it involves three parties: the client, the server, and the Key Distribution 
            Center (KDC). Kerberos v5 (RFC 4120) is the current standard and is the primary authentication 
            protocol in Microsoft Active Directory environments.
          </p>

          <h2 id="components">Kerberos Components</h2>
          
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Component</th>
                  <th>Description</th>
                  <th>Role</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>KDC (Key Distribution Center)</strong></td>
                  <td>Central authentication server</td>
                  <td>Issues tickets, maintains secrets database</td>
                </tr>
                <tr>
                  <td><strong>AS (Authentication Service)</strong></td>
                  <td>Part of KDC</td>
                  <td>Authenticates users, issues TGTs</td>
                </tr>
                <tr>
                  <td><strong>TGS (Ticket Granting Service)</strong></td>
                  <td>Part of KDC</td>
                  <td>Issues service tickets using TGTs</td>
                </tr>
                <tr>
                  <td><strong>TGT (Ticket Granting Ticket)</strong></td>
                  <td>User's authentication proof</td>
                  <td>Used to request service tickets</td>
                </tr>
                <tr>
                  <td><strong>Service Ticket (TGS Ticket)</strong></td>
                  <td>Access credential for specific service</td>
                  <td>Presented to access resources</td>
                </tr>
                <tr>
                  <td><strong>Principal</strong></td>
                  <td>Unique identity (user or service)</td>
                  <td>Format: name@REALM or service/host@REALM</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h2 id="authentication-flow">Kerberos Authentication Flow</h2>
          
          <div class="flow-diagram">
            <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KERBEROS AUTHENTICATION FLOW                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   CLIENT   â”‚                    â”‚           KDC              â”‚              â”‚
â”‚  â”‚   (User)   â”‚                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                    â”‚  â”‚    AS    â”‚    TGS    â”‚  â”‚              â”‚
â”‚        â”‚                           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚              â”‚
â”‚        â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚        â”‚                                                                        â”‚
â”‚   STEP 1: AS-REQ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                â”‚
â”‚   â”‚  Client requests TGT                                                        â”‚
â”‚   â”‚  Contains: Username, Timestamp (encrypted with user's key)                 â”‚
â”‚   â”‚                                                                             â”‚
â”‚   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STEP 2: AS-REP      â”‚
â”‚        â”‚  KDC returns TGT + Session Key                                        â”‚
â”‚        â”‚  TGT encrypted with krbtgt key (only KDC can decrypt)                â”‚
â”‚        â”‚  Session Key encrypted with user's key                                â”‚
â”‚        â”‚                                                                        â”‚
â”‚   STEP 3: TGS-REQ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                â”‚
â”‚   â”‚  Client requests Service Ticket                                            â”‚
â”‚   â”‚  Contains: TGT + Authenticator + Service Principal Name                   â”‚
â”‚   â”‚                                                                             â”‚
â”‚   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STEP 4: TGS-REP     â”‚
â”‚        â”‚  KDC returns Service Ticket                                           â”‚
â”‚        â”‚  Service Ticket encrypted with service's key                         â”‚
â”‚        â”‚                                                                        â”‚
â”‚        â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚        â”‚              â”‚   SERVICE   â”‚                                          â”‚
â”‚        â”‚              â”‚   SERVER    â”‚                                          â”‚
â”‚        â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚        â”‚                     â”‚                                                  â”‚
â”‚   STEP 5: AP-REQ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                  â”‚
â”‚   â”‚  Client presents Service Ticket + Authenticator                           â”‚
â”‚   â”‚                          â”‚                                                  â”‚
â”‚   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ STEP 6: AP-REP      â”‚
â”‚        Access Granted!       â”‚  (Optional mutual authentication)               â”‚
â”‚                              â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </pre>
          </div>

          <h3>Step-by-Step Explanation</h3>
          <div class="steps">
            <div class="step">
              <div class="step-number">1</div>
              <div class="step-content">
                <h4>AS-REQ (Authentication Service Request)</h4>
                <p>Client sends username and timestamp encrypted with their password-derived key to the KDC. This proves the user knows the password without sending it over the network.</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">2</div>
              <div class="step-content">
                <h4>AS-REP (Authentication Service Response)</h4>
                <p>KDC validates the request, creates a TGT encrypted with the krbtgt account's key, and a session key encrypted with the user's key. Only the KDC can create valid TGTs.</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">3</div>
              <div class="step-content">
                <h4>TGS-REQ (Ticket Granting Service Request)</h4>
                <p>Client presents TGT with an authenticator (timestamp encrypted with session key) to request a service ticket for a specific service (SPN).</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">4</div>
              <div class="step-content">
                <h4>TGS-REP (Ticket Granting Service Response)</h4>
                <p>KDC decrypts TGT, validates authenticator, and issues a service ticket encrypted with the target service's key.</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">5</div>
              <div class="step-content">
                <h4>AP-REQ (Application Request)</h4>
                <p>Client presents service ticket to the target service. Service decrypts ticket with its own key to validate the client's identity.</p>
              </div>
            </div>
          </div>

          <h2 id="attacks">Kerberos Attacks</h2>

          <div class="callout critical">
            <div class="callout-content">
              <div class="callout-title">ğŸ”´ Golden Ticket Attack</div>
              <p>
                An attacker who compromises the <strong>krbtgt</strong> account hash can forge TGTs for any user, 
                including non-existent users, with any group memberships. This provides complete domain dominance.
              </p>
              <ul>
                <li><strong>Requirement:</strong> krbtgt NTLM hash (requires Domain Admin access to extract)</li>
                <li><strong>Impact:</strong> Forge TGTs for any user, persistent access even after password changes</li>
                <li><strong>Detection:</strong> TGT lifetime anomalies, ticket without prior AS-REQ</li>
                <li><strong>Mitigation:</strong> Reset krbtgt password twice, monitor for anomalous tickets</li>
              </ul>
            </div>
          </div>

          <div class="callout warning">
            <div class="callout-content">
              <div class="callout-title">âš ï¸ Silver Ticket Attack</div>
              <p>
                An attacker who compromises a service account's password hash can forge service tickets 
                for that specific service without contacting the KDC.
              </p>
              <ul>
                <li><strong>Requirement:</strong> Service account NTLM hash</li>
                <li><strong>Impact:</strong> Access to the specific service, bypasses KDC logging</li>
                <li><strong>Detection:</strong> Service ticket without prior TGS-REQ in KDC logs</li>
                <li><strong>Mitigation:</strong> Use gMSAs, PAC validation, AES encryption</li>
              </ul>
            </div>
          </div>

          <h3>Other Kerberos Attacks</h3>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Attack</th>
                  <th>Description</th>
                  <th>Mitigation</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Kerberoasting</strong></td>
                  <td>Request service tickets and crack offline</td>
                  <td>Strong service account passwords, AES encryption</td>
                </tr>
                <tr>
                  <td><strong>AS-REP Roasting</strong></td>
                  <td>Target accounts without pre-auth</td>
                  <td>Enable pre-authentication for all accounts</td>
                </tr>
                <tr>
                  <td><strong>Pass-the-Ticket</strong></td>
                  <td>Steal and reuse valid tickets</td>
                  <td>Credential Guard, short ticket lifetimes</td>
                </tr>
                <tr>
                  <td><strong>Overpass-the-Hash</strong></td>
                  <td>Use NTLM hash to get Kerberos tickets</td>
                  <td>Credential Guard, Windows Defender ATP</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h2 id="ad-integration">Active Directory Integration</h2>
          <p>
            In Active Directory environments, every Domain Controller acts as a KDC. The krbtgt account 
            is automatically created and its password hash is used to encrypt all TGTs in the domain.
          </p>

          <div class="code-block">
            <div class="code-header">
              <span class="code-language">PowerShell - View Kerberos Tickets</span>
              <button class="code-copy-btn"><span>ğŸ“‹</span> Copy</button>
            </div>
            <pre><code># View current Kerberos tickets
klist

# View tickets with more detail
klist tickets

# Purge all tickets (force re-authentication)
klist purge

# View TGT information
klist tgt</code></pre>
          </div>

          <h2 id="best-practices">Best Practices</h2>
          <ul>
            <li><strong>Use AES Encryption:</strong> Disable RC4 (arcfour-hmac) and DES encryption types</li>
            <li><strong>Short Ticket Lifetimes:</strong> Reduce TGT and service ticket lifetimes (default 10 hours)</li>
            <li><strong>Protected Users Group:</strong> Add privileged accounts to prevent NTLM and reduce ticket lifetime</li>
            <li><strong>Credential Guard:</strong> Enable on Windows 10/Server 2016+ to protect secrets in memory</li>
            <li><strong>Group Managed Service Accounts:</strong> Use gMSAs instead of regular service accounts</li>
            <li><strong>Monitor krbtgt:</strong> Alert on any krbtgt password changes not initiated by administrators</li>
          </ul>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview">
            <div class="callout-content">
              <div class="callout-title">ğŸ’¡ Key Points Interviewers Look For</div>
              <ul>
                <li>Ability to explain the complete Kerberos flow (AS-REQ â†’ AS-REP â†’ TGS-REQ â†’ TGS-REP â†’ AP-REQ)</li>
                <li>Understanding of TGT vs Service Ticket and what encrypts each</li>
                <li>Knowledge of Golden vs Silver ticket attacks and their prerequisites</li>
                <li>Awareness of Kerberoasting and AS-REP roasting attack vectors</li>
                <li>Understanding of why krbtgt is critical and how to protect it</li>
                <li>Knowledge of detection strategies for Kerberos attacks</li>
              </ul>
              <p style="margin-top: 1rem;"><strong>Sample Question:</strong> "Explain the difference between a Golden Ticket and Silver Ticket attack. What does an attacker need for each, and how would you detect them?"</p>
            </div>
          </div>

          <nav class="page-nav">
            <a href="2-1-authentication-factors.html" class="page-nav-link prev">
              <span class="page-nav-label">â† Previous</span>
              <span class="page-nav-title">Authentication Factors</span>
            </a>
            <a href="2-3-ntlm.html" class="page-nav-link next">
              <span class="page-nav-label">Next â†’</span>
              <span class="page-nav-title">NTLM</span>
            </a>
          </nav>
        </article>
        <aside class="toc">
          <div class="toc-header">On This Page</div>
          <ul class="toc-list"></ul>
        </aside>
      </div>
    </main>
    <div class="search-modal">
      <div class="search-container">
        <div class="search-input-wrapper">
          <svg class="search-input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
          <input type="text" class="search-input" placeholder="Search documentation...">
        </div>
        <div class="search-results"></div>
      </div>
    </div>
  </div>
  <script src="main.js"></script>
</body>
</html>