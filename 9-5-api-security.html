<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Security - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
      <!-- Navigation generated by JavaScript -->
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l2">L2 Technical</div>
          <h1>API Security</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What This Page Covers</h3>
            <p>Securing APIs with OAuth 2.0, API gateways, token validation, rate limiting, and API-specific threats.</p>
          </div>

          <h2 id="api-auth-patterns">API Authentication Patterns</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Pattern</th><th>Use Case</th><th>Security</th></tr></thead>
            <tbody>
              <tr><td><strong>OAuth 2.0 Bearer Token</strong></td><td>User-context API calls</td><td>âœ… Recommended</td></tr>
              <tr><td><strong>Client Credentials</strong></td><td>Service-to-service (M2M)</td><td>âœ… Recommended</td></tr>
              <tr><td><strong>API Key</strong></td><td>Simple integrations, public APIs</td><td>âš ï¸ Limited (no user context)</td></tr>
              <tr><td><strong>Mutual TLS (mTLS)</strong></td><td>High-security service mesh</td><td>âœ… Strong</td></tr>
              <tr><td><strong>Basic Auth</strong></td><td>Legacy only</td><td>âŒ Avoid</td></tr>
            </tbody>
          </table></div>

          <h2 id="oauth-for-apis">OAuth 2.0 for API Access</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">API Protection with OAuth</span></div><pre><code># API receives request with Bearer token
GET /api/users HTTP/1.1
Authorization: Bearer eyJhbGciOiJSUzI1NiIs...

# API must validate:
1. Token signature (verify with IdP's public key)
2. Token not expired (exp claim)
3. Issuer is trusted (iss claim)
4. Audience matches this API (aud claim)
5. Scopes include required permissions (scope claim)

# Example token claims:
{
  "iss": "https://login.microsoftonline.com/tenant/v2.0",
  "aud": "api://my-api",
  "sub": "user-id",
  "scope": "api.read api.write",
  "exp": 1704067200
}

# Scope-based authorization:
if "api.write" not in token.scope:
    return 403 Forbidden</code></pre></div>

          <h2 id="api-gateway">API Gateway Security</h2>
          <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API GATEWAY SECURITY FUNCTIONS                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   CLIENT                    API GATEWAY                        BACKEND API              â”‚
â”‚     â”‚                          â”‚                                  â”‚                     â”‚
â”‚     â”‚  Request + Token         â”‚                                  â”‚                     â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                                  â”‚                     â”‚
â”‚     â”‚                          â”‚                                  â”‚                     â”‚
â”‚     â”‚                    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                           â”‚                     â”‚
â”‚     â”‚                    â”‚ VALIDATE  â”‚                           â”‚                     â”‚
â”‚     â”‚                    â”‚ â€¢ Token   â”‚                           â”‚                     â”‚
â”‚     â”‚                    â”‚ â€¢ Rate    â”‚                           â”‚                     â”‚
â”‚     â”‚                    â”‚ â€¢ Schema  â”‚                           â”‚                     â”‚
â”‚     â”‚                    â”‚ â€¢ Threats â”‚                           â”‚                     â”‚
â”‚     â”‚                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                           â”‚                     â”‚
â”‚     â”‚                          â”‚ Forward (if valid)              â”‚                     â”‚
â”‚     â”‚                          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                     â”‚
â”‚     â”‚                          â”‚                                  â”‚                     â”‚
â”‚     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚     â”‚  Response                â”‚                                  â”‚                     â”‚
â”‚                                                                                          â”‚
â”‚   Gateway Functions: Authentication, Rate Limiting, Request Validation,                 â”‚
â”‚                     Threat Protection, Logging, Caching                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>

          <h2 id="api-threats">API-Specific Threats</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Threat</th><th>Description</th><th>Mitigation</th></tr></thead>
            <tbody>
              <tr><td><strong>Broken Object Level Auth</strong></td><td>Access other users' data by changing ID</td><td>Always verify ownership</td></tr>
              <tr><td><strong>Broken Function Level Auth</strong></td><td>Access admin functions as regular user</td><td>Check roles/scopes per endpoint</td></tr>
              <tr><td><strong>Excessive Data Exposure</strong></td><td>API returns more data than needed</td><td>Filter responses, use DTOs</td></tr>
              <tr><td><strong>Rate Limiting Bypass</strong></td><td>DDoS or brute force</td><td>Per-user and per-IP limits</td></tr>
              <tr><td><strong>Injection</strong></td><td>SQL/NoSQL injection via API</td><td>Input validation, parameterized queries</td></tr>
            </tbody>
          </table></div>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview"><div class="callout-content"><div class="callout-title">ğŸ’¡ Key Interview Points</div>
            <ul>
              <li><strong>OAuth for APIs:</strong> Bearer tokens with scope-based authorization</li>
              <li><strong>Token validation:</strong> Signature, expiry, issuer, audience, scopes</li>
              <li><strong>API Gateway:</strong> Central point for auth, rate limiting, threat protection</li>
              <li><strong>OWASP API Top 10:</strong> Know Broken Object/Function Level Authorization</li>
              <li><strong>Machine-to-machine:</strong> Use client credentials flow</li>
            </ul>
          </div></div>

          <nav class="page-nav">
            <a href="9-4-ciam-architecture.html" class="page-nav-link prev"><span class="page-nav-label">â† Previous</span><span class="page-nav-title">CIAM Architecture</span></a>
            <a href="9-6-high-availability.html" class="page-nav-link next"><span class="page-nav-label">Next â†’</span><span class="page-nav-title">High Availability</span></a>
          </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
