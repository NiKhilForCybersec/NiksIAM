<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detection & Response - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
      <!-- Navigation generated by JavaScript -->
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l3">L3 Expert</div>
          <h1>Identity Threat Detection & Response</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What This Page Covers</h3>
            <p>Detecting and responding to identity-based attacks using SIEM, UEBA, and ITDR. This covers detection strategies, key log sources, and incident response playbooks.</p>
          </div>

          <h2 id="log-sources">Critical Log Sources</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Source</th><th>Key Events</th><th>Attacks Detected</th></tr></thead>
            <tbody>
              <tr><td><strong>Entra ID Sign-in Logs</strong></td><td>All authentications, MFA, CA decisions</td><td>Password spray, MFA bypass, impossible travel</td></tr>
              <tr><td><strong>Entra ID Audit Logs</strong></td><td>Config changes, role assignments</td><td>Privilege escalation, persistence</td></tr>
              <tr><td><strong>AD Security Events</strong></td><td>4624, 4625, 4768, 4769, 4776</td><td>Kerberoasting, DCSync, lateral movement</td></tr>
              <tr><td><strong>Okta System Log</strong></td><td>user.session.*, app.*, policy.*</td><td>Account takeover, policy bypass</td></tr>
              <tr><td><strong>AWS CloudTrail</strong></td><td>IAM, STS events</td><td>Privilege escalation, key compromise</td></tr>
            </tbody>
          </table></div>

          <h2 id="detection-rules">Key Detection Rules</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">Detection Logic Examples</span></div><pre><code># PASSWORD SPRAY DETECTION
WHEN count(failed_login) > 10 
  AND distinct(username) > 5
  AND source_ip = same
  AND timewindow = 10min
THEN alert "Password Spray Attack"

# IMPOSSIBLE TRAVEL
WHEN user has login from location_A
  AND user has login from location_B
  AND time_diff < calculated_travel_time
  AND distance > 500km
THEN alert "Impossible Travel"

# PRIVILEGE ESCALATION
WHEN user assigned to (Global Admin OR Domain Admin)
  AND assigner != approved_admins
THEN alert "Suspicious Privilege Assignment"

# TOKEN THEFT (Post-Compromise)
WHEN access_token used from new_device
  AND no prior authentication from that device
  AND user risk = none (no MFA prompt)
THEN alert "Potential Token Theft"</code></pre></div>

          <h2 id="response-playbook">Incident Response Playbook</h2>
          <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COMPROMISED ACCOUNT RESPONSE                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   CONTAIN (First 15 min)                                                                â”‚
â”‚   â”œâ”€â”€ Revoke all sessions: Revoke-MgUserSignInSession                                  â”‚
â”‚   â”œâ”€â”€ Disable account (if severity warrants)                                           â”‚
â”‚   â”œâ”€â”€ Block sign-in via Conditional Access                                             â”‚
â”‚   â””â”€â”€ Reset password (force at next sign-in)                                           â”‚
â”‚                                                                                          â”‚
â”‚   INVESTIGATE (Hours)                                                                   â”‚
â”‚   â”œâ”€â”€ Review sign-in logs (unusual locations, IPs, devices)                            â”‚
â”‚   â”œâ”€â”€ Review audit logs (what did attacker do?)                                        â”‚
â”‚   â”œâ”€â”€ Check for persistence (new MFA methods, app passwords)                           â”‚
â”‚   â”œâ”€â”€ Check mailbox rules and forwarding                                               â”‚
â”‚   â”œâ”€â”€ Review OAuth app consents                                                        â”‚
â”‚   â””â”€â”€ Identify scope (other compromised accounts?)                                     â”‚
â”‚                                                                                          â”‚
â”‚   REMEDIATE                                                                             â”‚
â”‚   â”œâ”€â”€ Remove attacker persistence mechanisms                                           â”‚
â”‚   â”œâ”€â”€ Re-register MFA (all methods)                                                    â”‚
â”‚   â”œâ”€â”€ Revoke all OAuth consents and re-consent                                         â”‚
â”‚   â”œâ”€â”€ Review and revert unauthorized changes                                           â”‚
â”‚   â””â”€â”€ Re-enable account with enhanced monitoring                                       â”‚
â”‚                                                                                          â”‚
â”‚   POST-INCIDENT                                                                         â”‚
â”‚   â”œâ”€â”€ Document timeline and actions                                                    â”‚
â”‚   â”œâ”€â”€ Identify root cause (phishing? weak password?)                                   â”‚
â”‚   â””â”€â”€ Implement controls to prevent recurrence                                         â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>

          <h2 id="itdr">ITDR Solutions</h2>
          <p>Identity Threat Detection and Response (ITDR) is an emerging category focused on identity-specific threats.</p>
          <div class="table-wrapper"><table>
            <thead><tr><th>Vendor</th><th>Focus</th><th>Key Capability</th></tr></thead>
            <tbody>
              <tr><td><strong>Microsoft Defender for Identity</strong></td><td>AD, Entra ID</td><td>On-prem AD attack detection</td></tr>
              <tr><td><strong>CrowdStrike Falcon Identity</strong></td><td>AD</td><td>Real-time AD threat prevention</td></tr>
              <tr><td><strong>Semperis</strong></td><td>AD</td><td>AD recovery and forensics</td></tr>
              <tr><td><strong>Silverfort</strong></td><td>All IdPs</td><td>MFA everywhere, identity firewall</td></tr>
            </tbody>
          </table></div>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview"><div class="callout-content"><div class="callout-title">ğŸ’¡ Key Interview Points</div>
            <ul>
              <li><strong>Key logs:</strong> Sign-in logs, audit logs, AD security events</li>
              <li><strong>First response:</strong> Revoke sessions, reset password, investigate</li>
              <li><strong>Check for persistence:</strong> MFA methods, app passwords, OAuth consents, mail rules</li>
              <li><strong>ITDR:</strong> Emerging category for identity-specific threat detection</li>
              <li><strong>MDI:</strong> Microsoft Defender for Identity - monitors AD for attacks</li>
            </ul>
          </div></div>

          <nav class="page-nav">
            <a href="11-4-privilege-escalation.html" class="page-nav-link prev"><span class="page-nav-label">â† Previous</span><span class="page-nav-title">Privilege Escalation</span></a>
            <a href="12-1-iam-glossary.html" class="page-nav-link next"><span class="page-nav-label">Next â†’</span><span class="page-nav-title">IAM Glossary</span></a>
          </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
