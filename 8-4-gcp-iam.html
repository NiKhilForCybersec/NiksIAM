<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GCP IAM - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
      <!-- Navigation generated by JavaScript -->
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l2">L2 Technical</div>
          <h1>GCP IAM</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What This Page Covers</h3>
            <p>Google Cloud IAM controls who can do what on which resources. This covers the resource hierarchy, roles, service accounts, and Workforce Identity Federation.</p>
          </div>

          <h2 id="hierarchy">Resource Hierarchy</h2>
          <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GCP RESOURCE HIERARCHY                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   Organization (company.com)           â† Domain-wide policies                           â”‚
â”‚         â”‚                                                                               â”‚
â”‚         â”œâ”€â”€ Folder (Engineering)       â† Group projects, inherit policies              â”‚
â”‚         â”‚       â”‚                                                                       â”‚
â”‚         â”‚       â”œâ”€â”€ Project (prod-app)  â† Billing boundary, contains resources         â”‚
â”‚         â”‚       â”‚       â”‚                                                               â”‚
â”‚         â”‚       â”‚       â”œâ”€â”€ Compute Engine VM                                          â”‚
â”‚         â”‚       â”‚       â”œâ”€â”€ Cloud Storage Bucket                                       â”‚
â”‚         â”‚       â”‚       â””â”€â”€ BigQuery Dataset                                           â”‚
â”‚         â”‚       â”‚                                                                       â”‚
â”‚         â”‚       â””â”€â”€ Project (dev-app)                                                   â”‚
â”‚         â”‚                                                                               â”‚
â”‚         â””â”€â”€ Folder (Finance)                                                            â”‚
â”‚                 â”‚                                                                       â”‚
â”‚                 â””â”€â”€ Project (finance-data)                                              â”‚
â”‚                                                                                          â”‚
â”‚   IAM INHERITANCE: Policies flow DOWN the hierarchy                                     â”‚
â”‚   Role at Org level â†’ applies to all folders, projects, resources                       â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>

          <h2 id="principals">Principal Types</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Principal</th><th>Format</th><th>Use Case</th></tr></thead>
            <tbody>
              <tr><td><strong>Google Account</strong></td><td>user:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="fb9a9792989ebb9c969a9297d5989496">[email&#160;protected]</a></td><td>Individual users</td></tr>
              <tr><td><strong>Service Account</strong></td><td>serviceAccount:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b2c1d3f2c2c0ddd8d7d1c69cdbd3df9cd5c1d7c0c4dbd1d7d3d1d1ddc7dcc69cd1dddf">[email&#160;protected]</a></td><td>Applications, VMs</td></tr>
              <tr><td><strong>Google Group</strong></td><td>group:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2342474e4a4d5063404c4e53424d5a0d404c4e">[email&#160;protected]</a></td><td>Teams (recommended)</td></tr>
              <tr><td><strong>Cloud Identity Domain</strong></td><td>domain:company.com</td><td>All users in domain</td></tr>
              <tr><td><strong>Workforce Identity</strong></td><td>principal://iam.googleapis.com/...</td><td>External IdP users</td></tr>
            </tbody>
          </table></div>

          <h2 id="role-types">Role Types</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Type</th><th>Example</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td><strong>Basic (Primitive)</strong></td><td>roles/owner, roles/editor, roles/viewer</td><td>Broad permissions, avoid in production</td></tr>
              <tr><td><strong>Predefined</strong></td><td>roles/compute.admin, roles/storage.objectViewer</td><td>Service-specific, Google-managed</td></tr>
              <tr><td><strong>Custom</strong></td><td>projects/my-project/roles/customRole</td><td>Your own permission combinations</td></tr>
            </tbody>
          </table></div>

          <h2 id="service-accounts">Service Accounts</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">gcloud CLI</span></div><pre><code># Create service account
gcloud iam service-accounts create my-sa \
  --display-name="My Service Account"

# Grant role to service account
gcloud projects add-iam-policy-binding my-project \
  --member="serviceAccount:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="eb8692c6988aab8692c69b9984818e889fc5828a86c58c988e999d82888e8a8888849e859fc5888486">[email&#160;protected]</a>" \
  --role="roles/storage.objectViewer"

# Create key (avoid if possible - use attached SA instead)
gcloud iam service-accounts keys create key.json \
  <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b69b9bdfd7db9bd7d5d5d9c3d8c28bdbcf9bc5d7f6dbcf9bc6c4d9dcd3d5c298dfd7db98d1c5d3c4c0dfd5d3d7d5d5d9c3d8c298d5d9db">[email&#160;protected]</a>

# Impersonate service account (preferred over keys)
gcloud auth print-access-token --impersonate-service-account=my-sa@...

# Attach SA to VM (no keys needed)
gcloud compute instances create my-vm \
  <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="97babae4f2e5e1fef4f2baf6f4f4f8e2f9e3aafaeebae4f6d7faeebae7e5f8fdf2f4e3b9fef6fab9f0e4f2e5e1fef4f2f6f4f4f8e2f9e3b9f4f8fa">[email&#160;protected]</a></code></pre></div>

          <h2 id="workforce-identity">Workforce Identity Federation</h2>
          <p>Allow external IdP users (Okta, Entra ID) to access GCP without Google accounts.</p>
          <div class="code-block"><div class="code-header"><span class="code-language">Workforce Identity</span></div><pre><code># Create workforce pool
gcloud iam workforce-pools create my-pool \
  --location="global" \
  --organization="123456789"

# Create OIDC provider (e.g., Okta)
gcloud iam workforce-pools providers create-oidc okta-provider \
  --workforce-pool="my-pool" \
  --location="global" \
  --issuer-uri="https://company.okta.com" \
  --client-id="0oa..." \
  --attribute-mapping="google.subject=assertion.sub"

# Grant access to workforce identity
gcloud projects add-iam-policy-binding my-project \
  --member="principalSet://iam.googleapis.com/locations/global/workforcePools/my-pool/attribute.department/engineering" \
  --role="roles/viewer"</code></pre></div>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview"><div class="callout-content"><div class="callout-title">ğŸ’¡ Key Interview Points</div>
            <ul>
              <li><strong>Hierarchy:</strong> Org â†’ Folder â†’ Project â†’ Resource (policies inherit down)</li>
              <li><strong>Avoid basic roles:</strong> owner/editor/viewer are too broad for production</li>
            </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
