<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secrets Management - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l2">L2 Technical</div>
          <h1>Secrets Management</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What This Page Covers</h3>
            <p>Secrets management protects API keys, passwords, certificates, and tokens used by applications. This covers HashiCorp Vault, cloud-native solutions (AWS Secrets Manager, Azure Key Vault), and implementation patterns.</p>
          </div>

          <h2 id="what-are-secrets">What Are Secrets?</h2>

          <div class="table-wrapper">
            <table>
              <thead><tr><th>Secret Type</th><th>Examples</th><th>Risk if Exposed</th></tr></thead>
              <tbody>
                <tr>
                  <td><strong>API Keys</strong></td>
                  <td>Stripe API key, Google Maps key</td>
                  <td>Unauthorized API usage, billing fraud</td>
                </tr>
                <tr>
                  <td><strong>Database Credentials</strong></td>
                  <td>PostgreSQL password, MongoDB connection string</td>
                  <td>Data breach, data destruction</td>
                </tr>
                <tr>
                  <td><strong>Service Account Passwords</strong></td>
                  <td>LDAP bind password, AD service account</td>
                  <td>Lateral movement, privilege escalation</td>
                </tr>
                <tr>
                  <td><strong>Certificates & Keys</strong></td>
                  <td>TLS certs, SSH private keys, signing keys</td>
                  <td>Impersonation, man-in-the-middle</td>
                </tr>
                <tr>
                  <td><strong>Tokens</strong></td>
                  <td>OAuth tokens, JWT signing keys</td>
                  <td>Account takeover, API abuse</td>
                </tr>
                <tr>
                  <td><strong>Encryption Keys</strong></td>
                  <td>AES keys, KMS keys</td>
                  <td>Data decryption, compliance violation</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h2 id="anti-patterns">Anti-Patterns (What NOT to Do)</h2>

          <div class="code-block">
            <div class="code-header"><span class="code-language">âŒ BAD: Secrets in Code</span></div>
            <pre><code># NEVER DO THIS - secrets in source code
database_password = "SuperSecret123!"
api_key = "sk_live_abc123xyz789"

# These get committed to Git and live forever in history
# Even if deleted, they're in the commit history
# Attackers scan GitHub for exposed secrets</code></pre>
          </div>

          <div class="code-block">
            <div class="code-header"><span class="code-language">âŒ BAD: Secrets in Environment Variables (Unmanaged)</span></div>
            <pre><code># Slightly better, but still problematic
export DB_PASSWORD="SuperSecret123!"

# Problems:
# - Visible in process listings (ps aux)
# - Logged in shell history
# - Inherited by child processes
# - No rotation mechanism
# - No audit trail</code></pre>
          </div>

          <h2 id="vault">HashiCorp Vault</h2>

          <div class="flow-diagram">
            <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HASHICORP VAULT ARCHITECTURE                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   APPLICATIONS                    VAULT                      SECRETS ENGINES            â”‚
â”‚                                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚ App Server  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ KV (key-value)  â”‚        â”‚
â”‚   â”‚             â”‚  Auth + Read  â”‚   VAULT API     â”‚         â”‚ Static secrets  â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚                 â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â”‚ Policies  â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Database        â”‚        â”‚
â”‚   â”‚ Kubernetes  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  â”‚ (ACLs)    â”‚  â”‚         â”‚ Dynamic creds   â”‚        â”‚
â”‚   â”‚ Pod         â”‚  K8s Auth     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚                 â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ PKI             â”‚        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â”‚ Audit Log â”‚  â”‚         â”‚ Certificates    â”‚        â”‚
â”‚   â”‚ CI/CD       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  â”‚           â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚   â”‚ Pipeline    â”‚  AppRole Auth â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ AWS/Azure/GCP   â”‚        â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ Cloud creds     â”‚        â”‚
â”‚                                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </pre>
          </div>

          <div class="code-block">
            <div class="code-header"><span class="code-language">Vault CLI Examples</span></div>
            <pre><code># Store a secret
vault kv put secret/myapp/database \
  username="app_user" \
  password="SuperSecret123!"

# Read a secret
vault kv get secret/myapp/database

# Read specific field
vault kv get -field=password secret/myapp/database

# Dynamic database credentials (auto-generated, auto-rotated)
vault read database/creds/my-role
# Returns: username=v-token-my-role-xyz, password=A1B2C3D4 (TTL: 1h)

# Generate PKI certificate
vault write pki/issue/my-role \
  common_name="app.example.com" \
  ttl="24h"</code></pre>
          </div>

          <h2 id="cloud-solutions">Cloud-Native Solutions</h2>

          <div class="table-wrapper">
            <table>
              <thead><tr><th>Platform</th><th>Service</th><th>Key Features</th></tr></thead>
              <tbody>
                <tr>
                  <td><strong>AWS</strong></td>
                  <td>Secrets Manager</td>
                  <td>Auto-rotation for RDS, cross-account, Lambda integration</td>
                </tr>
                <tr>
                  <td><strong>AWS</strong></td>
                  <td>Parameter Store</td>
                  <td>Free tier, simpler, good for config + secrets</td>
                </tr>
                <tr>
                  <td><strong>Azure</strong></td>
                  <td>Key Vault</td>
                  <td>HSM-backed, managed identities, certificate management</td>
                </tr>
                <tr>
                  <td><strong>GCP</strong></td>
                  <td>Secret Manager</td>
                  <td>Versioning, IAM integration, automatic replication</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="code-block">
            <div class="code-header"><span class="code-language">AWS Secrets Manager Example</span></div>
            <pre><code># Store secret
aws secretsmanager create-secret \
  --name "prod/myapp/database" \
  --secret-string '{"username":"admin","password":"SuperSecret123!"}'

# Retrieve secret
aws secretsmanager get-secret-value \
  --secret-id "prod/myapp/database"

# In application code (Python)
import boto3
import json

client = boto3.client('secretsmanager')
response = client.get_secret_value(SecretId='prod/myapp/database')
secret = json.loads(response['SecretString'])
db_password = secret['password']

# Enable auto-rotation (RDS)
aws secretsmanager rotate-secret \
  --secret-id "prod/myapp/database" \
  --rotation-lambda-arn "arn:aws:lambda:..." \
  --rotation-rules AutomaticallyAfterDays=30</code></pre>
          </div>

          <h2 id="best-practices">Best Practices</h2>

          <div class="callout tip">
            <div class="callout-content">
              <div class="callout-title">âœ… Secrets Management Checklist</div>
              <ul>
                <li><strong>Never hardcode:</strong> No secrets in code, config files, or Dockerfiles</li>
                <li><strong>Rotate regularly:</strong> Automate rotation (30-90 days for credentials)</li>
                <li><strong>Least privilege:</strong> Apps only access secrets they need</li>
                <li><strong>Audit access:</strong> Log who accessed what secret and when</li>
                <li><strong>Encrypt at rest:</strong> Secrets encrypted in vault storage</li>
                <li><strong>Short-lived:</strong> Use dynamic secrets when possible (TTL)</li>
                <li><strong>Separate environments:</strong> Different secrets for dev/staging/prod</li>
              </ul>
            </div>
          </div>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview">
            <div class="callout-content">
              <div class="callout-title">ğŸ’¡ Key Interview Points</div>
              <ul>
                <li><strong>Secrets types:</strong> API keys, database creds, certificates, tokens</li>
                <li><strong>Anti-patterns:</strong> Hardcoded secrets, unmanaged env vars</li>
                <li><strong>HashiCorp Vault:</strong> Industry standard, dynamic secrets, multiple auth methods</li>
                <li><strong>Cloud solutions:</strong> AWS Secrets Manager, Azure Key Vault, GCP Secret Manager</li>
                <li><strong>Dynamic secrets:</strong> Generated on-demand, short TTL, auto-revoke</li>
                <li><strong>Rotation:</strong> Automated credential rotation without app changes</li>
              </ul>
            </div>
          </div>

          <nav class="page-nav">
            <a href="7-4-jit-access.html" class="page-nav-link prev">
              <span class="page-nav-label">â† Previous</span>
              <span class="page-nav-title">Just-in-Time Access</span>
            </a>
            <a href="7-6-pam-vendors.html" class="page-nav-link next">
              <span class="page-nav-label">Next â†’</span>
              <span class="page-nav-title">PAM Vendors</span>
            </a>
          </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
