<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SAML 2.0 - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l2">L2 Technical</div>
          <h1>SAML 2.0</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What You'll Learn</h3>
            <p>SAML (Security Assertion Markup Language) is the go-to protocol for enterprise SSO. If you've ever clicked "Sign in with your company account" on a SaaS app, you've used SAML. This page makes it click.</p>
          </div>

          <!-- SIMPLE ANALOGY -->
          <h2 id="simple-analogy">ğŸ­ The Hotel & Travel Agent Analogy</h2>
          <div class="callout tip"><div class="callout-content"><div class="callout-title">ğŸ¨ Think of SAML Like Booking Through a Travel Agent</div>
            
            <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ¨ HOTEL BOOKING = SAML AUTHENTICATION                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   YOU                       =  USER (Employee wanting to access an app)                 â”‚
â”‚   (Want a hotel room)                                                                   â”‚
â”‚                                                                                          â”‚
â”‚   TRAVEL AGENT              =  IdP (Identity Provider - Okta, Entra ID)                 â”‚
â”‚   (Books on your behalf)       The company that KNOWS who you are                       â”‚
â”‚   (Has your info on file)      and vouches for you                                      â”‚
â”‚                                                                                          â”‚
â”‚   HOTEL                     =  SP (Service Provider - Salesforce, Workday)              â”‚
â”‚   (Where you want to stay)     The app that TRUSTS the IdP                              â”‚
â”‚                                                                                          â”‚
â”‚   CONFIRMATION LETTER       =  SAML ASSERTION                                           â”‚
â”‚   (Proves your booking)        "This user is john.smith, they work in Sales,            â”‚
â”‚                                 they are authenticated - signed, Okta"                  â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>
            
            <p><strong>The Story:</strong> You (user) want to check into a hotel (Salesforce). Instead of the hotel verifying your identity directly, your travel agent (Okta) vouches for you by sending a signed confirmation letter (SAML Assertion) that says "This is John Smith, he's paid up, let him in."</p>
          </div></div>

          <!-- MEMORY TRICKS -->
          <h2 id="memory-tricks">ğŸ§  Memory Tricks</h2>
          <div class="callout warning"><div class="callout-content"><div class="callout-title">ğŸ’¡ Remember These Forever</div>
            
            <p><strong>ğŸ†” IdP = "I Declare (who you are) Provider"</strong></p>
            <p>The IdP is like HR - they KNOW who you are. Examples: Okta, Entra ID, Ping, ADFS</p>

            <p style="margin-top:1rem;"><strong>ğŸ¯ SP = "Service (that you want) Provider"</strong></p>
            <p>The SP is the app you're trying to access. Examples: Salesforce, Workday, ServiceNow</p>

            <p style="margin-top:1rem;"><strong>ğŸ“œ Assertion = "A Statement About You"</strong></p>
            <p>The IdP creates a signed document saying: "This user is X, they have attributes Y, signed by me."</p>

            <p style="margin-top:1rem;"><strong>ğŸ”¢ Key Numbers:</strong></p>
            <ul>
              <li><strong>SAML 2.0</strong> = The version everyone uses (1.0 and 1.1 are dead)</li>
              <li><strong>XML</strong> = SAML uses XML format (unlike OIDC which uses JSON)</li>
              <li><strong>POST</strong> = SAML assertions sent via browser POST redirect</li>
            </ul>
          </div></div>

          <!-- THE FLOW -->
          <h2 id="flow">ğŸ“ SAML Flow in Plain English</h2>
          <div class="callout info"><div class="callout-content"><div class="callout-title">ğŸš¶ SP-Initiated Flow (Most Common)</div>
            <p><em>"I go to the app, app sends me to IdP, IdP sends me back with a golden ticket"</em></p>
            
            <p><strong>Step 1: You go to Salesforce</strong></p>
            <p>You type salesforce.com and click "Login with SSO"</p>
            <p>â†’ Salesforce says: "I don't know you. Go prove yourself to your IdP."</p>
            
            <p style="margin-top:1rem;"><strong>Step 2: Redirect to IdP (Okta)</strong></p>
            <p>Your browser is redirected to your company's Okta login page</p>
            <p>â†’ If already logged in: Skip to Step 4</p>
            <p>â†’ If not: Enter username/password, complete MFA</p>
            
            <p style="margin-top:1rem;"><strong>Step 3: IdP Creates Assertion</strong></p>
            <p>Okta creates a SAML Assertion (an XML document) that says:</p>
            <ul>
              <li>Who you are: john.smith@company.com</li>
              <li>Your attributes: Department=Sales, Role=Manager</li>
              <li>When this expires: In 5 minutes</li>
              <li>Digital signature: "Signed by Okta" (proves it wasn't tampered)</li>
            </ul>
            
            <p style="margin-top:1rem;"><strong>Step 4: Back to Salesforce</strong></p>
            <p>Your browser POSTs the assertion to Salesforce</p>
            <p>â†’ Salesforce validates the signature (using Okta's public certificate)</p>
            <p>â†’ Salesforce reads your attributes, logs you in</p>
            <p>â†’ <strong>You're in!</strong> Never entered a Salesforce password.</p>
          </div></div>

          <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SP-INITIATED SAML FLOW                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   USER                        SP (Salesforce)                IdP (Okta)                 â”‚
â”‚   â”€â”€â”€â”€                        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚
â”‚     â”‚                               â”‚                             â”‚                     â”‚
â”‚     â”‚ â‘  "I want salesforce.com"     â”‚                             â”‚                     â”‚
â”‚     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                             â”‚                     â”‚
â”‚     â”‚                               â”‚                             â”‚                     â”‚
â”‚     â”‚ â‘¡ "Go to Okta to prove who you are" (SAML Request)         â”‚                     â”‚
â”‚     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚                     â”‚
â”‚     â”‚                               â”‚                             â”‚                     â”‚
â”‚     â”‚ â‘¢ Redirect to Okta with SAML Request                       â”‚                     â”‚
â”‚     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
â”‚     â”‚                               â”‚                             â”‚                     â”‚
â”‚     â”‚                               â”‚    â‘£ Authenticate           â”‚                     â”‚
â”‚     â”‚                               â”‚    (if not already)         â”‚                     â”‚
â”‚     â”‚                               â”‚                             â”‚                     â”‚
â”‚     â”‚ â‘¤ "Here's your proof" (SAML Response with Assertion)       â”‚                     â”‚
â”‚     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”‚     â”‚                               â”‚                             â”‚                     â”‚
â”‚     â”‚ â‘¥ POST assertion to Salesforce                             â”‚                     â”‚
â”‚     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                             â”‚                     â”‚
â”‚     â”‚                               â”‚                             â”‚                     â”‚
â”‚     â”‚ â‘¦ "Welcome John!"             â”‚                             â”‚                     â”‚
â”‚     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚                     â”‚
â”‚     â”‚                               â”‚                             â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>

          <!-- KEY TERMINOLOGY -->
          <h2 id="terminology">ğŸ“š Key Terms (With Plain English)</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Term</th><th>Technical Definition</th><th>Plain English</th></tr></thead>
            <tbody>
              <tr><td><strong>IdP (Identity Provider)</strong></td><td>System that authenticates users</td><td>Your company's login system (Okta, Entra)</td></tr>
              <tr><td><strong>SP (Service Provider)</strong></td><td>Application relying on IdP</td><td>The app you want to use (Salesforce)</td></tr>
              <tr><td><strong>Assertion</strong></td><td>XML document with claims</td><td>A signed letter about who you are</td></tr>
              <tr><td><strong>Entity ID</strong></td><td>Unique identifier for IdP/SP</td><td>Like a mailing address - must match exactly</td></tr>
              <tr><td><strong>ACS URL</strong></td><td>Assertion Consumer Service</td><td>Where to send the assertion (Salesforce's mailbox)</td></tr>
              <tr><td><strong>NameID</strong></td><td>User identifier in assertion</td><td>Your username/email that the SP understands</td></tr>
              <tr><td><strong>Metadata</strong></td><td>XML config for IdP/SP</td><td>The "instruction manual" for setup</td></tr>
            </tbody>
          </table></div>

          <!-- COMMON ERRORS -->
          <h2 id="troubleshooting">ğŸ”§ Common SAML Errors (And What They Mean)</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">Troubleshooting Guide</span></div><pre><code>ERROR: "Audience Mismatch"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WHAT IT MEANS: The Entity ID configured in the IdP doesn't match 
               what the SP expects.
EXAMPLE: IdP has "https://salesforce.com/mycompany"
         SP expects "https://salesforce.com/mycompany/" (note trailing /)
FIX: Check Entity IDs match EXACTLY (case sensitive, trailing slashes matter)

ERROR: "Invalid Signature" 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WHAT IT MEANS: SP can't verify the assertion was signed by the IdP
COMMON CAUSES:
  - IdP certificate rotated but SP still has old cert
  - Certificate expired
  - Wrong certificate uploaded
FIX: Re-download IdP certificate, re-upload to SP

ERROR: "Response Expired / NotOnOrAfter"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WHAT IT MEANS: Time difference between IdP and SP servers
COMMON CAUSE: Server clocks out of sync by more than 5 minutes
FIX: Sync both servers to NTP time source

ERROR: "User Not Found"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WHAT IT MEANS: The NameID in assertion doesn't match a user in SP
EXAMPLE: IdP sends "jsmith" but SP expects "john.smith@company.com"
FIX: Configure correct NameID format (email, username, etc.)

ERROR: "ACS URL Mismatch"  
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WHAT IT MEANS: Assertion sent to wrong URL
FIX: Update ACS URL in IdP to match SP's actual endpoint

PRO TIP: Use SAML-tracer browser extension to capture and decode 
         SAML requests/responses during troubleshooting!</code></pre></div>

          <!-- INTERVIEW TIPS -->
          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview"><div class="callout-content"><div class="callout-title">ğŸ’¡ How to Nail SAML Questions</div>
            
            <p><strong>If asked "Explain SAML":</strong></p>
            <p>"SAML is an XML-based protocol for SSO. The Identity Provider, like Okta, authenticates users and creates a signed assertion - essentially a signed document saying 'this is John Smith, he works in Sales.' That assertion is sent to the Service Provider, like Salesforce, which validates the signature and logs the user in. The user never enters a password in Salesforce."</p>

            <p style="margin-top:1rem;"><strong>If asked "SAML vs OIDC":</strong></p>
            <p>"SAML uses XML and was designed for web SSO - it's the enterprise standard. OIDC uses JSON and was designed for modern apps, mobile, and APIs. SAML is older but still dominant in enterprise. OIDC is simpler and better for developers. Many orgs use both - SAML for enterprise apps, OIDC for modern apps."</p>

            <p style="margin-top:1rem;"><strong>If asked "SP-initiated vs IdP-initiated":</strong></p>
            <p>"SP-initiated means the user goes to the app first, then gets redirected to the IdP - this is more secure because it includes anti-replay protection. IdP-initiated means the user starts at the IdP portal and clicks an app - it's convenient but slightly less secure, and some apps don't support it."</p>
          </div></div>

          <h2 id="quick-reference">âš¡ Quick Reference Card</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">SAML Cheat Sheet</span></div><pre><code>SAML = Security Assertion Markup Language
VERSION = 2.0 (always assume this)
FORMAT = XML

KEY PLAYERS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
IdP = Identity Provider (Okta, Entra ID, ADFS)
SP = Service Provider (Salesforce, Workday)
Assertion = Signed XML document about the user

KEY URLS TO CONFIGURE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Entity ID = Unique identifier (must match exactly!)
ACS URL = Where SP receives assertions
SSO URL = IdP's login endpoint
SLO URL = Single Logout endpoint

WHAT'S IN AN ASSERTION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- NameID (who the user is)
- Attributes (department, role, email)
- Conditions (valid from, valid until)
- Signature (proves it's from the IdP)

TROUBLESHOOTING TOOLS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- SAML-tracer (browser extension)
- base64 decode the SAMLResponse
- Check Entity IDs match exactly
- Check clocks are synced (NTP)</code></pre></div>

          <nav class="page-nav">
            <a href="2-3-ntlm.html" class="page-nav-link prev"><span class="page-nav-label">â† Previous</span><span class="page-nav-title">NTLM</span></a>
            <a href="2-5-oauth2.html" class="page-nav-link next"><span class="page-nav-label">Next â†’</span><span class="page-nav-title">OAuth 2.0</span></a>
          </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
