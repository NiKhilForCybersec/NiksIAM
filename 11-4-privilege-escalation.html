<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Privilege Escalation - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">üîê</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
      <!-- Navigation generated by JavaScript -->
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l3">L3 Expert</div>
          <h1>Privilege Escalation</h1>
          
          <div class="overview-box">
            <h3>üéØ What This Page Covers</h3>
            <p>Privilege escalation attacks elevate attacker access from standard user to admin. This covers AD attacks (Kerberoasting, DCSync), cloud escalation paths, and detection.</p>
          </div>

          <h2 id="ad-attacks">Active Directory Privilege Escalation</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Attack</th><th>Technique</th><th>Result</th><th>Detection</th></tr></thead>
            <tbody>
              <tr><td><strong>Kerberoasting</strong></td><td>Request service tickets, crack offline</td><td>Service account passwords</td><td>4769 events, encryption downgrade</td></tr>
              <tr><td><strong>AS-REP Roasting</strong></td><td>Attack accounts without pre-auth</td><td>User passwords</td><td>4768 without pre-auth</td></tr>
              <tr><td><strong>DCSync</strong></td><td>Replicate password hashes from DC</td><td>All domain hashes</td><td>4662 with replication rights</td></tr>
              <tr><td><strong>Golden Ticket</strong></td><td>Forge TGT with krbtgt hash</td><td>Persistent domain admin</td><td>TGT without AS-REQ</td></tr>
              <tr><td><strong>Silver Ticket</strong></td><td>Forge service ticket</td><td>Access to specific service</td><td>Service access without TGS</td></tr>
            </tbody>
          </table></div>

          <h2 id="cloud-escalation">Cloud Privilege Escalation</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Platform</th><th>Path</th><th>Impact</th></tr></thead>
            <tbody>
              <tr><td><strong>Entra ID</strong></td><td>Application Admin ‚Üí Add creds to app ‚Üí Use app permissions</td><td>Depends on app perms</td></tr>
              <tr><td><strong>Entra ID</strong></td><td>Privileged Auth Admin ‚Üí Reset Global Admin password</td><td>Global Admin</td></tr>
              <tr><td><strong>AWS</strong></td><td>iam:PassRole + create function ‚Üí Attach high-priv role</td><td>Role permissions</td></tr>
              <tr><td><strong>AWS</strong></td><td>iam:CreateAccessKey on another user</td><td>Access as that user</td></tr>
              <tr><td><strong>Azure</strong></td><td>Contributor + User Access Admin = Owner equivalent</td><td>Full subscription control</td></tr>
            </tbody>
          </table></div>

          <h2 id="dcsync">DCSync Attack Detail</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">DCSync Attack</span></div><pre><code># Requires: DS-Replication-Get-Changes and DS-Replication-Get-Changes-All
# These permissions are normally only on Domain Controllers

# Using Mimikatz:
mimikatz # lsadump::dcsync /user:krbtgt
mimikatz # lsadump::dcsync /user:Administrator

# Result: NTLM hash for any user including krbtgt
# With krbtgt hash ‚Üí Golden Ticket ‚Üí Persistent Domain Admin

# Detection:
# Event ID 4662 with:
# - Operation: ReplicateDirectoryChangesAll
# - From non-DC source
# - Properties containing password attributes

# Prevention:
# - Limit accounts with replication rights
# - Monitor for DCSync from non-DCs
# - Use AdminSDHolder to protect privileged accounts</code></pre></div>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview"><div class="callout-content"><div class="callout-title">üí° Key Interview Points</div>
            <ul>
              <li><strong>Kerberoasting:</strong> Any domain user can request service tickets, crack offline</li>
              <li><strong>DCSync:</strong> Replicate hashes without touching DC disk</li>
              <li><strong>Golden Ticket:</strong> Forged TGT, requires krbtgt hash, persists across password resets</li>
              <li><strong>Cloud paths:</strong> iam:PassRole (AWS), Application Admin (Entra) are common escalation paths</li>
              <li><strong>Detection:</strong> Monitor replication events, unusual privilege use</li>
            </ul>
          </div></div>

          <nav class="page-nav">
            <a href="11-3-token-session-attacks.html" class="page-nav-link prev"><span class="page-nav-label">‚Üê Previous</span><span class="page-nav-title">Token Attacks</span></a>
            <a href="11-5-detection-response.html" class="page-nav-link next"><span class="page-nav-label">Next ‚Üí</span><span class="page-nav-title">Detection & Response</span></a>
          </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
