<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Authentication Attacks & Defense - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
      <!-- Navigation generated by JavaScript -->
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l2">L2 Technical</div>
          <h1>Authentication Attacks & Defense</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What This Page Covers</h3>
            <p>Common authentication attacks including credential stuffing, password spray, phishing, MFA bypass techniques, and the defensive controls security engineers implement.</p>
          </div>

          <h2 id="attack-types">Authentication Attack Types</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Attack</th><th>Technique</th><th>Detection</th><th>Defense</th></tr></thead>
            <tbody>
              <tr><td><strong>Password Spray</strong></td><td>Common passwords across many users</td><td>Many failed logins, same password</td><td>Smart lockout, banned passwords</td></tr>
              <tr><td><strong>Credential Stuffing</strong></td><td>Leaked creds from other breaches</td><td>High failure rate from one IP</td><td>Password breach detection, MFA</td></tr>
              <tr><td><strong>Brute Force</strong></td><td>Try all passwords for one user</td><td>Many failures for one user</td><td>Account lockout, rate limiting</td></tr>
              <tr><td><strong>Phishing</strong></td><td>Fake login page captures creds</td><td>Logins from new IPs post-phish</td><td>FIDO2, user training</td></tr>
              <tr><td><strong>MFA Fatigue</strong></td><td>Spam push until user approves</td><td>Multiple MFA prompts quickly</td><td>Number matching, rate limit</td></tr>
              <tr><td><strong>AiTM Phishing</strong></td><td>Proxy captures session token</td><td>Session from unusual location</td><td>FIDO2 (phishing-resistant)</td></tr>
            </tbody>
          </table></div>

          <h2 id="password-spray">Password Spray Attack</h2>
          <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PASSWORD SPRAY ATTACK                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   ATTACKER                                             TARGET                           â”‚
â”‚                                                                                          â”‚
â”‚   Step 1: Enumerate usernames (LinkedIn, email harvest, etc.)                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚   â”‚ user1@company.com, user2@company.com, ...    â”‚                                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                                                          â”‚
â”‚   Step 2: Try ONE common password against ALL users                                     â”‚
â”‚                                                                                          â”‚
â”‚   Password1! â”€â”€â–º user1@company.com â”€â”€â–º âŒ Fail                                          â”‚
â”‚   Password1! â”€â”€â–º user2@company.com â”€â”€â–º âŒ Fail                                          â”‚
â”‚   Password1! â”€â”€â–º user3@company.com â”€â”€â–º âœ… SUCCESS!                                      â”‚
â”‚   Password1! â”€â”€â–º user4@company.com â”€â”€â–º âŒ Fail                                          â”‚
â”‚                                                                                          â”‚
â”‚   Wait 30 minutes (avoid lockout)                                                       â”‚
â”‚                                                                                          â”‚
â”‚   Step 3: Try NEXT password against all users                                           â”‚
â”‚   Summer2024! â”€â”€â–º ...                                                                   â”‚
â”‚                                                                                          â”‚
â”‚   WHY IT WORKS: Avoids per-user lockout, common passwords are common                   â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>

          <h2 id="defenses">Defensive Controls</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">Defense Configuration</span></div><pre><code># ENTRA ID PASSWORD PROTECTION
Azure Portal â†’ Entra ID â†’ Security â†’ Authentication Methods â†’ Password Protection
â”œâ”€â”€ Enable banned password list
â”œâ”€â”€ Add custom banned words (company name, city, etc.)
â””â”€â”€ Enforce on password change

# SMART LOCKOUT (Entra ID)
Security â†’ Authentication Methods â†’ Password Protection
â”œâ”€â”€ Lockout threshold: 10 failed attempts
â”œâ”€â”€ Lockout duration: 60 seconds (increases with repeated lockouts)
â””â”€â”€ Uses ML to distinguish user vs attacker

# CONDITIONAL ACCESS - BLOCK LEGACY AUTH
Entra ID â†’ Conditional Access â†’ New Policy
â”œâ”€â”€ Name: "Block Legacy Authentication"
â”œâ”€â”€ Users: All users
â”œâ”€â”€ Cloud apps: All
â”œâ”€â”€ Conditions: Client apps â†’ Exchange ActiveSync, Other clients
â”œâ”€â”€ Grant: Block access

# WHY BLOCK LEGACY: Legacy protocols don't support MFA, perfect for spray attacks

# RISK-BASED ACCESS (Identity Protection)
Conditional Access â†’ New Policy
â”œâ”€â”€ Conditions: Sign-in risk = Medium or High
â”œâ”€â”€ Grant: Require MFA (or block if High)</code></pre></div>

          <h2 id="day-to-day">ğŸ”§ Security Engineer Day-to-Day Tasks</h2>
          <div class="callout tip"><div class="callout-content"><div class="callout-title">ğŸ‘¨â€ğŸ’» What You Actually Do</div>
            
            <p><strong>Monitoring for Attacks:</strong></p>
            <ul>
              <li>Review failed authentication reports daily</li>
              <li>Investigate spikes in failed logins</li>
              <li>Check Identity Protection risky sign-ins</li>
              <li>Monitor for legacy auth attempts</li>
            </ul>

            <p><strong>Incident Response:</strong></p>
            <ul>
              <li>Identify scope of spray attack (which users targeted)</li>
              <li>Reset passwords for compromised accounts</li>
              <li>Force MFA re-registration if MFA bypassed</li>
              <li>Block malicious IPs at firewall/WAF</li>
            </ul>

            <p><strong>Proactive Defense:</strong></p>
            <ul>
              <li>Run phishing simulations</li>
              <li>Review and update banned password list</li>
              <li>Audit for accounts without MFA</li>
              <li>Test detection rules work correctly</li>
            </ul>
          </div></div>

          <h2 id="detection">Detection Queries</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">Sentinel/Splunk Detection</span></div><pre><code># SENTINEL - Password Spray Detection
SigninLogs
| where ResultType == "50126"  // Invalid username or password
| summarize FailedAttempts = count(), 
            DistinctUsers = dcount(UserPrincipalName),
            Users = make_set(UserPrincipalName, 100)
    by IPAddress, bin(TimeGenerated, 10m)
| where DistinctUsers > 10 and FailedAttempts > 20
| project TimeGenerated, IPAddress, DistinctUsers, FailedAttempts

# SENTINEL - Successful login after spray
let SprayIPs = SigninLogs
    | where ResultType == "50126"
    | summarize by IPAddress;
SigninLogs
| where ResultType == 0  // Success
| where IPAddress in (SprayIPs)
| project TimeGenerated, UserPrincipalName, IPAddress, AppDisplayName

# SPLUNK - Password Spray
index=azure sourcetype=azure:aad:signin result=50126
| stats count as failures dc(user) as unique_users by src_ip
| where unique_users > 10 AND failures > 20</code></pre></div>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview"><div class="callout-content"><div class="callout-title">ğŸ’¡ Key Interview Points</div>
            <ul>
              <li><strong>Password spray:</strong> One password against many users (avoids lockout)</li>
              <li><strong>Credential stuffing:</strong> Leaked credentials from other breaches</li>
              <li><strong>Block legacy auth:</strong> No MFA support = perfect for attacks</li>
              <li><strong>Smart lockout:</strong> ML-based lockout that distinguishes users from attackers</li>
              <li><strong>FIDO2:</strong> Only defense against AiTM phishing attacks</li>
            </ul>
          </div></div>

          <nav class="page-nav">
            <a href="2-9-sso-mechanisms.html" class="page-nav-link prev"><span class="page-nav-label">â† Previous</span><span class="page-nav-title">SSO Mechanisms</span></a>
            <a href="3-1-federation-fundamentals.html" class="page-nav-link next"><span class="page-nav-label">Next â†’</span><span class="page-nav-title">Federation Fundamentals</span></a>
          </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
