<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Workload Identity - Ultimate IAM Security Guide</title>
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <div class="page-wrapper">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle navigation">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <nav class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <div class="sidebar-logo-icon">ğŸ”</div>
          <div class="sidebar-logo-text">IAM <span>Guide</span></div>
        </a>
      </div>
      <!-- Navigation generated by JavaScript -->
    </nav>
    <main class="main-content">
      <div class="content-wrapper">
        <article class="content-main">
          <div class="badge badge-l2">L2 Technical</div>
          <h1>Workload Identity</h1>
          
          <div class="overview-box">
            <h3>ğŸ¯ What This Page Covers</h3>
            <p>Workload identities are non-human identities for applications, services, and automation. This covers Managed Identities, Service Principals, Workload Identity Federation, and how security engineers manage these day-to-day.</p>
          </div>

          <h2 id="identity-types">Workload Identity Types</h2>
          <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WORKLOAD IDENTITY TYPES IN ENTRA ID                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   MANAGED IDENTITY                    SERVICE PRINCIPAL                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ â€¢ Azure-managed credentials â”‚    â”‚ â€¢ You manage credentials    â”‚                   â”‚
â”‚   â”‚ â€¢ No secrets to rotate      â”‚    â”‚ â€¢ Client secret or cert     â”‚                   â”‚
â”‚   â”‚ â€¢ Auto token refresh        â”‚    â”‚ â€¢ Manual rotation required  â”‚                   â”‚
â”‚   â”‚ â€¢ Azure resources only      â”‚    â”‚ â€¢ Any app, any platform     â”‚                   â”‚
â”‚   â”‚                             â”‚    â”‚                             â”‚                   â”‚
â”‚   â”‚ Types:                      â”‚    â”‚ Types:                      â”‚                   â”‚
â”‚   â”‚ â€¢ System-assigned (1:1)     â”‚    â”‚ â€¢ App Registration SP       â”‚                   â”‚
â”‚   â”‚ â€¢ User-assigned (reusable)  â”‚    â”‚ â€¢ Enterprise App SP         â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                                          â”‚
â”‚   WORKLOAD IDENTITY FEDERATION (NEW)                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚ â€¢ No secrets at all - uses external IdP tokens                  â”‚                   â”‚
â”‚   â”‚ â€¢ GitHub Actions, Kubernetes, AWS, GCP can get Entra tokens     â”‚                   â”‚
â”‚   â”‚ â€¢ Best practice for CI/CD pipelines                             â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>

          <h2 id="managed-identity">Managed Identity Deep Dive</h2>
          <div class="table-wrapper"><table>
            <thead><tr><th>Type</th><th>Lifecycle</th><th>Use Case</th><th>Limitation</th></tr></thead>
            <tbody>
              <tr><td><strong>System-Assigned</strong></td><td>Created/deleted with resource</td><td>Single VM needs Key Vault access</td><td>Can't share across resources</td></tr>
              <tr><td><strong>User-Assigned</strong></td><td>Independent lifecycle</td><td>Multiple VMs share same identity</td><td>More to manage</td></tr>
            </tbody>
          </table></div>

          <div class="code-block"><div class="code-header"><span class="code-language">Using Managed Identity (Python)</span></div><pre><code># No credentials needed - Azure handles everything
from azure.identity import DefaultAzureCredential
from azure.keyvault.secrets import SecretClient

# DefaultAzureCredential automatically uses Managed Identity on Azure
credential = DefaultAzureCredential()

# Access Key Vault without any secrets in code
client = SecretClient(
    vault_url="https://my-vault.vault.azure.net",
    credential=credential
)

secret = client.get_secret("database-password")
print(f"Retrieved secret: {secret.value}")

# The magic: No client_id, no client_secret, no certificates
# Azure injects identity into the VM/App Service automatically</code></pre></div>

          <h2 id="workload-federation">Workload Identity Federation</h2>
          <div class="flow-diagram"><pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GITHUB ACTIONS â†’ AZURE (No Secrets!)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   GITHUB ACTIONS                        ENTRA ID                    AZURE               â”‚
â”‚         â”‚                                  â”‚                          â”‚                 â”‚
â”‚         â”‚ 1. GitHub issues OIDC token      â”‚                          â”‚                 â”‚
â”‚         â”‚    (signed JWT with repo info)   â”‚                          â”‚                 â”‚
â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                          â”‚                 â”‚
â”‚         â”‚                                  â”‚                          â”‚                 â”‚
â”‚         â”‚                                  â”‚ 2. Validate token:       â”‚                 â”‚
â”‚         â”‚                                  â”‚    - Issuer = GitHub     â”‚                 â”‚
â”‚         â”‚                                  â”‚    - Subject = repo/branch                 â”‚
â”‚         â”‚                                  â”‚    - Audience = Azure    â”‚                 â”‚
â”‚         â”‚                                  â”‚                          â”‚                 â”‚
â”‚         â”‚ 3. Return Azure access token     â”‚                          â”‚                 â”‚
â”‚         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                          â”‚                 â”‚
â”‚         â”‚                                  â”‚                          â”‚                 â”‚
â”‚         â”‚ 4. Deploy with Azure token       â”‚                          â”‚                 â”‚
â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                 â”‚
â”‚         â”‚                                  â”‚                          â”‚                 â”‚
â”‚                                                                                          â”‚
â”‚   NO SECRETS STORED IN GITHUB! Just trust relationship configured in Entra ID          â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre></div>

          <h2 id="day-to-day">ğŸ”§ Security Engineer Day-to-Day Tasks</h2>
          <div class="callout tip"><div class="callout-content"><div class="callout-title">ğŸ‘¨â€ğŸ’» What You Actually Do</div>
            
            <p><strong>Weekly Tasks:</strong></p>
            <ul>
              <li>Review expiring client secrets (Entra ID â†’ App Registrations â†’ filter by expiry)</li>
              <li>Audit service principal permissions for over-privileged apps</li>
              <li>Check for unused service principals (no sign-ins in 90 days)</li>
              <li>Review Conditional Access exclusions for workload identities</li>
            </ul>

            <p><strong>Common Requests You Handle:</strong></p>
            <ul>
              <li>"My app needs access to Key Vault" â†’ Create Managed Identity, assign RBAC role</li>
              <li>"CI/CD pipeline needs Azure access" â†’ Set up Workload Identity Federation</li>
              <li>"Our client secret expired" â†’ Rotate secret, update Key Vault, notify app team</li>
              <li>"New SaaS app needs SSO" â†’ Create Enterprise App, configure SAML/OIDC</li>
            </ul>

            <p><strong>Incident Response:</strong></p>
            <ul>
              <li>Exposed client secret in GitHub â†’ Immediately rotate, check audit logs for abuse</li>
              <li>Suspicious SP sign-in â†’ Review permissions, check for unauthorized changes</li>
            </ul>
          </div></div>

          <h2 id="operations">Operational Procedures</h2>
          <div class="code-block"><div class="code-header"><span class="code-language">Common Operations (PowerShell)</span></div><pre><code># FIND EXPIRING SECRETS (Run weekly)
Connect-MgGraph -Scopes "Application.Read.All"

$apps = Get-MgApplication -All
$expiringApps = foreach ($app in $apps) {
    foreach ($secret in $app.PasswordCredentials) {
        if ($secret.EndDateTime -lt (Get-Date).AddDays(30)) {
            [PSCustomObject]@{
                AppName = $app.DisplayName
                AppId = $app.AppId
                SecretExpiry = $secret.EndDateTime
                DaysLeft = ($secret.EndDateTime - (Get-Date)).Days
            }
        }
    }
}
$expiringApps | Sort-Object DaysLeft | Format-Table

# FIND OVER-PRIVILEGED SERVICE PRINCIPALS
# Look for SPs with Directory.ReadWrite.All, Application.ReadWrite.All, etc.

# AUDIT UNUSED SERVICE PRINCIPALS
$signInLogs = Get-MgAuditLogSignIn -Filter "signInEventTypes/any(t: t eq 'servicePrincipal')" -Top 1000
# Compare against all SPs to find those with no recent activity

# ROTATE CLIENT SECRET
$newSecret = Add-MgApplicationPassword -ApplicationId $appId -PasswordCredential @{
    DisplayName = "Rotated-$(Get-Date -Format 'yyyy-MM-dd')"
    EndDateTime = (Get-Date).AddYears(1)
}
# Store new secret in Key Vault, notify app team, remove old secret after verification</code></pre></div>

          <h2 id="best-practices">Best Practices Checklist</h2>
          <div class="callout warning"><div class="callout-content"><div class="callout-title">âš ï¸ Security Requirements</div>
            <ul>
              <li>âœ… Use Managed Identity whenever possible (no secrets to manage)</li>
              <li>âœ… Use Workload Identity Federation for CI/CD (GitHub Actions, Azure DevOps)</li>
              <li>âœ… If client secret required: max 12-month expiry, store in Key Vault</li>
              <li>âœ… Use certificates over secrets for higher security</li>
              <li>âœ… Apply least privilege - only permissions the app actually needs</li>
              <li>âœ… Create Conditional Access policies for workload identities</li>
              <li>âœ… Monitor service principal sign-ins in SIEM</li>
              <li>âŒ Never commit secrets to source code</li>
              <li>âŒ Never use 2-year secrets (max 12 months)</li>
              <li>âŒ Don't grant admin consent without security review</li>
            </ul>
          </div></div>

          <h2 id="interview-tips">Interview Tips</h2>
          <div class="callout interview"><div class="callout-content"><div class="callout-title">ğŸ’¡ Key Interview Points</div>
            <ul>
              <li><strong>Managed Identity:</strong> Azure-managed, no secrets, auto-rotation - always prefer this</li>
              <li><strong>Service Principal:</strong> You manage credentials, use for non-Azure or complex scenarios</li>
              <li><strong>Workload Federation:</strong> Trust external IdP tokens, great for GitHub/K8s</li>
              <li><strong>Secret hygiene:</strong> Short expiry, store in vault, monitor for exposure</li>
              <li><strong>Common issue:</strong> Expired secrets causing app outages - proactive monitoring!</li>
            </ul>
          </div></div>

          <nav class="page-nav">
            <a href="4-7-hybrid-identity.html" class="page-nav-link prev"><span class="page-nav-label">â† Previous</span><span class="page-nav-title">Hybrid Identity</span></a>
            <a href="5-1-okta-overview.html" class="page-nav-link next"><span class="page-nav-label">Next â†’</span><span class="page-nav-title">Okta Overview</span></a>
          </nav>
        </article>
      </div>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>
